# 關聯式模型
- 將資料庫表示成一個由許多關聯所組成的集合
- 每個關聯就像是一個表格
- 關聯的階度:此關聯的屬性個數
- 關聯在資料庫中是由兩個部分組成
    - 表頭：一定數目的屬性集合及屬性的定義域組成
    - 主體：由值組的集合所組成，紀錄資料隨時間變動
- 定義域：某種資料型態的所有可能值所構成的集合
    - 例如：年齡的定義域可能為整數0-99
- 屬性：描述關聯本體的特性
- Tuple之間沒有順序性、Attribute之間也沒有順序性
- 所有屬性皆為單元值
    - 即不可再分解的值
    - 又稱簡單值、純量值
- 一個關聯中不含重複的Tuple

|   非正式術語   |  正式術語   |
|:-------------:|:----------:|
|     表格       |    關聯    |
|     欄位       |    屬性    |
|      列        |    值組    |
|欄位中的資料範圍 |   定義域    |
|表格的定義       |  關聯綱要   |

# 空值(Null Value)
- 一種特殊記號，紀錄目前不詳的資料值
- 可應用空值：此值**確實存在**但目前未知
- 不可應用的空值：此值**確實不存在**
- 完全未知的空值：此值不知道是否存在

# 鍵值
- 超鍵
    - 一個或多個屬性集合，具有唯一識別性
    - 最小的超鍵可為單一屬性
    - 最大的超鍵為全部的屬性集合
    - 在識別唯一性中，可能包含多餘屬性
- 候選鍵
    - 是具有**最少屬性集合**的超鍵
    - 具備唯一性
    - 最小性：刪除候選鍵集合中任一屬性就不具備唯一性
- 主鍵
    - 在多個候選鍵選出其中一個，成為主鍵
    - 在屬性名稱下方畫一條實底線
    - 主鍵不得為空值
    - 一個關聯只會有一個主鍵
- 替代鍵
    - 各候選鍵中，除了主鍵之外的其他候選鍵
- 外來鍵
    - 外來鍵通常會在其他關聯中扮演主鍵的角色
    - 在屬性名稱下方畫一條虛底線
    - 特性：
        - 維持一致性
        - 不具唯一性
        - 一個關連可能有多個外來鍵
        - 可以為空值
        - 不可含有任何不相配的外來鍵

# 關聯限制
- 完整性限制
    - 個體完整性限制
        - 限制對象：主鍵
        - 主鍵不得為空值，不可以重複出現
    - 參考完整性限制：
        - 限制對象：外來鍵
        - 外來鍵可以是空值，或是一個相匹配於其他關聯之主鍵之值
            - 外來鍵有參考到某關聯之主鍵時，此主鍵必須存在
- 定義域限制
    - 限制對象：關聯中的每個屬性
    - 每個屬性值須在該屬性定義域的範圍下
    - 須為單元值

# 資料操作與違反限制的情況
- 插入、刪除或更新都不能違反關聯限制
- 插入與更新有可能違反所有限制、刪除可能違反參考完整性限制

### Employee Table

| EmployeeId(PK) | Name   | Phone   | DepartNo(FK)|
|----------------|--------|---------|-------------|
|      A123      | Julia  | 1234567 |     002     |
|      A323      |  Aoi   | 7654321 |     004     |
|      A911      | Hitomi | 4321765 |     006     |

### Department Table

|  DepartNo(PK)  |   Name  |  City    |
|----------------|---------|----------|
|       002      |  Info   | Taipei   |
|       004      |  Sale   | Taipei   |
|       006      | Product | Taichung |

- 插入範例：

    - 插入('A233','Koi','0987654')
        - 允許
        - 滿足完整性限制 
    - 插入('A123','Julia','1234567','004')
        - 不允許
        - 主鍵不可以重複，違反**個體完整性限制**
    - 插入(NULL,'Julia','1234567',NULL)
        - 不允許
        - 主鍵不可以為空值，違反**個體完整性限制**

    - 插入('A233','Julia','1234567',003)
        - 不允許
        - 外來鍵在對應的表格中需有對應資料，違反**參考完整性限制**

- 刪除：
    - 欲刪除某關聯中的紀錄，若該紀錄中的鍵值沒有被其他關聯的外來鍵參考到，允許刪除
    - 若被參考到，採下列方法：
        - 限制：不允許刪除
        - 連帶(Cascade)：同時刪除對應關聯參考外來鍵之紀錄
        - 空值化：將該參考外來鍵設為空值

- 更新：
    - 欲更新某關聯中的紀錄，若該紀錄中的鍵值沒有被其他關聯的外來鍵參考到，允許更新
    - 若被參考到，採下列方法：
        - 限制：同上述刪除方法
        - 連帶：同上述刪除方法，一起更新
        - 空值化：同上述刪除方法